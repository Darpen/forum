{% extends 'base.html.twig' %}

{% block title %}{{ topic.title }}{% endblock %}

{% block body %}
    <h1>{{ topic.title }}</h1>
    <div class="d-flex justify-content-between align-items-center">
        <span>Créé le {{ topic.createdAt|date('d/m/Y H:i')|replace({' ': ' à ', ':':'h'}) }} par {{ topic.user.username }}</span>
        {% include "topic/close.html.twig" %}
    </div>
    
    <div id="js_show_messages">
        {% include "message/show.html.twig" %}
    </div>
    {% if topic.state == 'OPENED' %}
        <p><b>Vous pouvez ajouter un message</b></p>
        {{ form_start(form) }}
            <input type="hidden" name="topic" value="{{topic.id}}">
        {{ form_end(form) }}
    {% else %}
        <p class="alert alert-warning">Le sujet est cloturé</p>    
    {% endif %}
{% endblock %}

{% block javascripts %}
<script>
    const addVoteUrl = "{{ path('vote_add', {'topicId': topic.id}) }}";
    (function() {
        console.log(addVoteUrl)
        //fetch(url, {
        //    method: 'POST',
        //    body: JSON.stringify({ 'arrayCheck':arrayCheck, 'dateStart':window.dateStart, 'dateEnd':window.dateEnd, "seasonId" : window.seasonChangerId }),
        //}).then(res => res.json()).then(res => {
        //    if (res.checkedSeasonDiff) location.reload();
        //    if(res.error) {
        //        $('#error').html(res.text);
        //        $('#js_spinner').html('');
        //    }
        //    if(res.path){
        //        if(res.type == 'publique'){
        //            window.location.href = res.path;
        //        }else if(res.type == 'privee'){
        //            window.loading = false;
        //            $('.js_saveActivitiesAndSlots').remove();
        //            $('#success').html('<p class="mt-3">'+res.path+'</p><button class="btn btn-pink"><a style="color: white; padding: 20px; text-decoration: none;" href="'+res.diffusion+'">Liste d\'invitation</a></button>');
        //        }
        //        $('#js_spinner').html('');
        //    }
        //})
    })();
</script>
{% endblock %}
